{% extends "base.html" %}

{% block body %}
                        <div class="source" align="center">
                            <div class="section">
                                <h2>
                                    Results
                                </h2>
                                <form action="" method="post">
                                    {% csrf_token %}
                                    <table style="width: 100%">
                                        <script type="text/javascript">
                                            function set_checkboxes(status) {
                                                checkboxes = document.getElementsByName('select_box');
                                                for(var i=0, n=checkboxes.length; i<n; i++) {
                                                    checkboxes[i].checked = status;
                                                }
                                            }
                                            function invert_checkboxes() {
                                                checkboxes = document.getElementsByName('select_box');
                                                for(var i=0, n=checkboxes.length; i<n; i++) {
                                                    checkboxes[i].checked = !checkboxes[i].checked;
                                                }
                                            }
                                            function open_selected() {
                                                checkboxes = document.getElementsByName('select_box');
                                                for(var i=0, n=checkboxes.length; i<n; i++) {
                                                    if (checkboxes[i].checked) {
                                                        window.open('../result/'+checkboxes[i].value, '_blank');
                                                    }
                                                }
                                            }
                                            function edit_outcome_click() {
                                                var outcome = prompt('Enter the new outcome for all currently filtered results: ');
                                                $.post('', {'new_outcome': outcome, 'csrfmiddlewaretoken': '{{ csrf_token }}'});
                                                window.location = window.location.href.replace(/result__outcome=[^&]+&/, 'result__outcome='+outcome+'&');
                                                window.location.reload();
                                            }
                                            function edit_outcome_category_click() {
                                                var outcome_category = prompt('Enter the new outcome category for all currently filtered results: ');
                                                $.post('', {'new_outcome_category': outcome_category, 'csrfmiddlewaretoken': '{{ csrf_token }}'});
                                                window.location = window.location.href.replace(/result__outcome_category=[^&]+&/, 'result__outcome_category='+outcome_category+'&');
                                                window.location.reload();
                                            }
                                        </script>
                                        <tr>
                                            <th style="text-align: center;">
                                                Page Selection
                                            </th>
                                            <th style="text-align: center;">
                                                Open Results
                                            </th>
                                            <th style="text-align: center;">
                                                Console Output
                                            </th>
                                            <th style="text-align: center;">
                                                Edit Filtered Results
                                            </th>
                                            <th style="text-align: center;">
                                                Delete Results
                                            </th>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="button" onclick="set_checkboxes(true)" value="Select All">
                                                </div>
                                            </td>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="button" onclick="open_selected()" value="Open Selected">
                                                </div>
                                            </td>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="submit" name="view_output" value="View Selected">
                                                </div>
                                            </td>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="button" value="Edit Outcome Categories" onclick="edit_outcome_category_click()">
                                                </div>
                                            </td>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="submit" name="delete" value="Delete Selected" onclick="return confirm('Are you sure you want to delete the selected results?');">
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="button" onclick="set_checkboxes(false)" value="Deselect All">
                                                </div>
                                            </td>
                                            <td>
                                            </td>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="submit" name="view_output_all" value="View All (Filtered)">
                                                </div>
                                            </td>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="button" name="edit_outcome" value="Edit Outcomes" onclick="edit_outcome_click()">
                                                </div>
                                            </td>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="submit" name="delete_all" value="Delete All (Filtered)" onclick="return confirm('Are you sure you want to delete the currently filtered results?');">
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div style="text-align: center;">
                                                    <input type="button" onclick="invert_checkboxes(true)" value="Invert Selection">
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                    <br>
                                    {% load django_tables2 %}
                                    {% render_table table %}
                                </form>
                            </div>
                        </div>
{% endblock %}
